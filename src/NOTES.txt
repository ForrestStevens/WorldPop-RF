After you create a predict_density.img file there are several steps that you must perform to get a final population map:

1. First we multiply a Water/No-Water binary 0/1 mask across the image to set densities to zero where there is classified water from the land-cover product.  This should also be performed in case you have land cover 250, or "Industrial" areas.  The following Raster Calculator was run, saving the water-masked density map as "predict_density_water.img":

	arcpy.RasterCalculator_sa("(/\AFG_lc_mosaic_reclass_missing_filled_rurb_8bit_prj_v210_agg.img/\ == 0)*/\predict_density.img/\","D:/Documents/Graduate School/Research/Population/Data/Modeling Work/output/AFG/predict_density_water.img")

2.	Next, we project the resulting density map to GCS_1984, saving the projected file as "prediction_density_water_gcs84.img":

	arcpy.ProjectRaster_management("D:/Documents/Graduate School/Research/Population/Data/Modeling Work/output/AFG/predict_density_water.img","D:/Documents/Graduate School/Research/Population/Data/Modeling Work/output/AFG/predict_density_water_gcs84.img","GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]]","NEAREST","0.0008333","#","#","PROJCS['World_Mollweide',GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]],PROJECTION['Mollweide'],PARAMETER['False_Easting',0.0],PARAMETER['False_Northing',0.0],PARAMETER['Central_Meridian',0.0],UNIT['Meter',1.0]]")

3.	After that, I created a zonal statistics image, using the _popdata.shp file and its OBJECTID as the zone code, summing the cells of the "prediction_density_water_gcs84.img" file into block sums inorder to divde through the density map to create per-zone proportions in the next step:


	# Replace a layer/table view name with a path to a dataset (which can be a layer file) or create the layer/table view within the script
	# The following inputs are layers or table views: "AFG_popdata", "predict_density_water_gcs84.img"
	arcpy.ZonalStatistics_sa("AFG_popdata","OBJECTID","predict_density_water_gcs84.img","D:/Documents/Graduate School/Research/Population/Data/Modeling Work/output/AFG/predict_density_water_gcs84_sum.img","SUM","DATA")

4.	Next, I created a raster image using Feature to Raster of the EST0910 population field from the AFG census data, snapping to the prediction density no-water image so that a final raster calculation will yield per cell population estimates weighted by our prediction density raster.  This census data population raster was saved in the AFG census data folder as "AFG_popdata_est0910.img":

	
	# Replace a layer/table view name with a path to a dataset (which can be a layer file) or create the layer/table view within the script
	# The following inputs are layers or table views: "AFG_popdata"
	arcpy.FeatureToRaster_conversion("AFG_popdata","EST0910","D:/Documents/Graduate School/Research/Population/Data/GIS/Census Data/Afghanistan/AFG_popdata_est0910.img","0.0008333")

5.	The last thing to do is run the following Raster Calculator expression to estimate the per pixel population using our prediction density weights.  The resulting population map was saved in the model output folder as "/Modeling Work/output/AFG/predict_est0910.img":

	arcpy.RasterCalculator_sa("(/\predict_density_water_gcs84.img/\ / /\predict_density_water_gcs84_sum/\) * /\AFG_popdata_est0910/\","D:/Documents/Graduate School/Research/Population/Data/Modeling Work/output/AFG/predict_est0910.img")

6.	Because Raster Calculator output is not compressed, and this needs to be 32-bit floating point pixel types, I ran the predict_est0910.img through "Copy Raster" and output it using RLE (set in the Environment Settings) as an ERDAS IMG file, and named the output predict_est0910_red.img:

	# Replace a layer/table view name with a path to a dataset (which can be a layer file) or create the layer/table view within the script
	# The following inputs are layers or table views: "predict_est0910"
	arcpy.CopyRaster_management("predict_est0910","D:/Documents/Graduate School/Research/Population/Data/Modeling Work/output/AFG/predict_est0910_red.img","#","#","#","NONE","NONE","32_BIT_FLOAT")



